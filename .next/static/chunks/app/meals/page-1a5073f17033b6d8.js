(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[697],{8927:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var i=a(5155),n=a(2115);function s(){let[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(null),[l,r]=(0,n.useState)(!1),[d,c]=(0,n.useState)({name:"",description:"",recipe:"",price:"",photoURL:""}),[o,p]=(0,n.useState)(null),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)([]),[b,g]=(0,n.useState)(!1),[y,j]=(0,n.useState)(null);async function f(){let e=await fetch("/api/meals"),a=await e.json();Array.isArray(a)?t(a):t([])}return(0,n.useEffect)(()=>{f()},[]),(0,i.jsxs)("div",{className:"p-8 max-w-3xl mx-auto",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Meals"}),a&&(0,i.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-30 z-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg max-w-md w-full",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Meal Details"}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("div",{className:"font-bold",children:a.name}),(0,i.jsx)("div",{className:"text-gray-700 mb-2",children:a.description}),(0,i.jsxs)("div",{className:"mb-2",children:["Price: ",(0,i.jsxs)("span",{className:"font-mono",children:["$",a.price.toFixed(2)]})]}),a.photoURL&&(0,i.jsx)("img",{src:a.photoURL,alt:a.name,className:"w-full h-40 object-cover rounded mb-2"}),(0,i.jsxs)("div",{className:"mb-2",children:["Recipe: ",(0,i.jsx)("span",{className:"font-mono",children:a.recipe})]}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("span",{className:"font-semibold",children:"Ingredients:"}),(0,i.jsx)("ul",{className:"list-disc ml-6",children:a.ingredients.map(e=>(0,i.jsxs)("li",{children:[e.ingredient.name," (",e.quantity,")"]},e.id))})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{className:"bg-yellow-500 text-white px-4 py-2 rounded",onClick:async()=>{var e;c({name:a.name,description:a.description,recipe:a.recipe,price:String(a.price),photoURL:null!=(e=a.photoURL)?e:""}),x(a.ingredients.map(e=>({ingredientId:e.ingredient.id,quantity:String(e.quantity)}))),p(a.id),r(!0),s(null);try{let e=await fetch("/api/ingredients"),t=await e.json();Array.isArray(t)&&t.every(e=>"object"==typeof e&&null!==e&&"id"in e&&"name"in e)?u(t):u([])}catch(e){u([])}},children:"Edit"}),(0,i.jsx)("button",{className:"bg-red-600 text-white px-4 py-2 rounded",onClick:async()=>{if(window.confirm("Are you sure you want to delete this meal?")){g(!0),j(null);try{if(!(await fetch("/api/meals?id=".concat(a.id),{method:"DELETE"})).ok)throw Error("Failed to delete meal");s(null),f()}catch(e){j("Failed to delete meal")}finally{g(!1)}}},children:"Delete"}),(0,i.jsx)("button",{className:"bg-gray-300 text-gray-800 px-4 py-2 rounded",onClick:()=>s(null),children:"Close"})]})]})}),(0,i.jsx)("button",{className:"mb-4 bg-blue-600 text-white px-4 py-2 rounded",onClick:async()=>{r(!0);try{let e=await fetch("/api/ingredients"),t=await e.json();Array.isArray(t)&&t.every(e=>"object"==typeof e&&null!==e&&"id"in e&&"name"in e)?u(t):u([])}catch(e){u([])}x([])},children:"Add Meal"}),l&&(0,i.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-30 z-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg max-w-md w-full",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold mb-4",children:o?"Edit Meal":"Add Meal"}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),g(!0),j(null);try{let e;if(!(o?await fetch("/api/meals?id=".concat(o),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:d.name,description:d.description,recipe:d.recipe,price:Number(d.price),photoURL:d.photoURL,ingredients:h.map(e=>({ingredientId:e.ingredientId,quantity:Number(e.quantity)}))})}):await fetch("/api/meals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:d.name,description:d.description,recipe:d.recipe,price:Number(d.price),photoURL:d.photoURL,ingredients:h.map(e=>({ingredientId:e.ingredientId,quantity:Number(e.quantity)}))})})).ok)throw Error(o?"Failed to update meal":"Failed to add meal");r(!1),c({name:"",description:"",recipe:"",price:"",photoURL:""}),x([]),p(null),f()}catch(e){j(o?"Failed to update meal":"Failed to add meal")}finally{g(!1)}},className:"space-y-3",children:[(0,i.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Name",value:d.name,onChange:e=>c(t=>({...t,name:e.target.value})),required:!0}),(0,i.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Description",value:d.description,onChange:e=>c(t=>({...t,description:e.target.value})),required:!0}),(0,i.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Recipe",value:d.recipe,onChange:e=>c(t=>({...t,recipe:e.target.value})),required:!0}),(0,i.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Price",type:"number",min:"0",step:"0.01",value:d.price,onChange:e=>c(t=>({...t,price:e.target.value})),required:!0}),(0,i.jsx)("input",{className:"border p-2 rounded w-full",placeholder:"Photo URL (optional)",value:d.photoURL,onChange:e=>c(t=>({...t,photoURL:e.target.value}))}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"font-semibold mb-1",children:"Ingredients"}),h.map((e,t)=>{var a;return(0,i.jsxs)("div",{className:"flex gap-2 mb-2 items-center",children:[(0,i.jsxs)("select",{className:"border p-2 rounded flex-1",value:e.ingredientId,onChange:e=>{let a=[...h];a[t]&&(a[t].ingredientId=e.target.value,x(a))},required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select ingredient"}),null==m?void 0:m.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.name," ",e.measurementUnit?"(".concat(e.measurementUnit.name,")"):""]},e.id))]}),(0,i.jsx)("input",{className:"border p-2 rounded w-24",type:"number",min:"0",step:"0.01",placeholder:"Quantity",value:null!=(a=e.quantity)?a:"",onChange:e=>{let a=[...h];a[t]&&(a[t].quantity=e.target.value,x(a))},required:!0}),(0,i.jsx)("button",{type:"button",className:"text-red-600 px-2",onClick:()=>x(h.filter((e,a)=>a!==t)),children:"Remove"})]},t)}),(0,i.jsx)("button",{type:"button",className:"bg-green-600 text-white px-2 py-1 rounded",onClick:()=>x([...h,{ingredientId:"",quantity:""}]),children:"Add Ingredient"})]}),y&&(0,i.jsx)("div",{className:"text-red-600 text-sm",children:y}),(0,i.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,i.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",disabled:b,children:"Add"}),(0,i.jsx)("button",{type:"button",className:"bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400",onClick:()=>r(!1),disabled:b,children:"Cancel"})]})]})]})}),(0,i.jsx)("ul",{className:"divide-y divide-gray-200",children:e.map(e=>(0,i.jsxs)("li",{className:"py-4 flex justify-between items-center cursor-pointer hover:bg-gray-50",onClick:()=>s(e),children:[(0,i.jsxs)("span",{className:"flex items-center gap-2",children:["photoURL"in e&&e.photoURL&&(0,i.jsx)("img",{src:e.photoURL,alt:e.name,className:"w-12 h-12 object-cover rounded"}),(0,i.jsx)("span",{className:"font-semibold",children:e.name})," ",(0,i.jsxs)("span",{className:"text-gray-500",children:["(",e.description,")"]})]}),(0,i.jsxs)("span",{className:"font-mono",children:["$",e.price.toFixed(2)]})]},e.id))})]})}},9188:(e,t,a)=>{Promise.resolve().then(a.bind(a,8927))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(9188)),_N_E=e.O()}]);